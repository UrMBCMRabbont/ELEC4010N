{"cells":[{"cell_type":"code","source":["# Standard library imports\n","import os\n","import shutil\n","import math\n","import copy\n","import gc\n","\n","# Third-party imports for data handling and scientific computation\n","import pandas as pd\n","import numpy as np\n","from sklearn.metrics import roc_auc_score, accuracy_score\n","\n","# PyTorch imports for deep learning\n","import torch\n","from torch import nn\n","import torch.nn.functional as F\n","from torch.optim import Adam\n","from torch.optim.lr_scheduler import ExponentialLR\n","from torch.utils.data import Dataset\n","from torchvision import transforms\n","from torchvision.datasets import ImageFolder\n","from torchvision.models import resnet50 as _resnet50\n","from torchsummary import summary\n","\n","# Other utilities\n","from PIL import Image\n","from tqdm import tqdm\n","import matplotlib.pyplot as plt"],"metadata":{"id":"1pYsgb1hWbbr","executionInfo":{"status":"ok","timestamp":1683901001570,"user_tz":-480,"elapsed":2,"user":{"displayName":"BonKong Lai","userId":"14934257860777894140"}}},"execution_count":73,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"Hci3KvN7ivcH"},"source":["### 1, Download and unzip data"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZXeyyLwuD6mr","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1683895765572,"user_tz":-480,"elapsed":17801,"user":{"displayName":"BonKong Lai","userId":"14934257860777894140"}},"outputId":"f502a425-20e5-4dbc-9445-111b5a0e3a10"},"outputs":[{"output_type":"stream","name":"stdout","text":["--2023-05-12 12:49:07--  https://isic-challenge-data.s3.amazonaws.com/2016/ISBI2016_ISIC_Part3_Training_Data.zip\n","Resolving isic-challenge-data.s3.amazonaws.com (isic-challenge-data.s3.amazonaws.com)... 3.5.28.164, 52.217.197.17, 52.216.27.76, ...\n","Connecting to isic-challenge-data.s3.amazonaws.com (isic-challenge-data.s3.amazonaws.com)|3.5.28.164|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 631625308 (602M) [application/zip]\n","Saving to: ‘ISBI2016_ISIC_Part3_Training_Data.zip’\n","\n","ISBI2016_ISIC_Part3 100%[===================>] 602.36M  85.0MB/s    in 7.5s    \n","\n","2023-05-12 12:49:15 (79.9 MB/s) - ‘ISBI2016_ISIC_Part3_Training_Data.zip’ saved [631625308/631625308]\n","\n","--2023-05-12 12:49:15--  https://isic-challenge-data.s3.amazonaws.com/2016/ISBI2016_ISIC_Part3_Test_Data.zip\n","Resolving isic-challenge-data.s3.amazonaws.com (isic-challenge-data.s3.amazonaws.com)... 52.217.124.81, 52.217.161.33, 52.216.43.17, ...\n","Connecting to isic-challenge-data.s3.amazonaws.com (isic-challenge-data.s3.amazonaws.com)|52.217.124.81|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 242932767 (232M) [application/zip]\n","Saving to: ‘ISBI2016_ISIC_Part3_Test_Data.zip’\n","\n","ISBI2016_ISIC_Part3 100%[===================>] 231.68M  85.8MB/s    in 2.7s    \n","\n","2023-05-12 12:49:18 (85.8 MB/s) - ‘ISBI2016_ISIC_Part3_Test_Data.zip’ saved [242932767/242932767]\n","\n","--2023-05-12 12:49:18--  https://isic-challenge-data.s3.amazonaws.com/2016/ISBI2016_ISIC_Part3_Training_GroundTruth.csv\n","Resolving isic-challenge-data.s3.amazonaws.com (isic-challenge-data.s3.amazonaws.com)... 52.217.124.81, 52.217.161.33, 52.216.43.17, ...\n","Connecting to isic-challenge-data.s3.amazonaws.com (isic-challenge-data.s3.amazonaws.com)|52.217.124.81|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 19419 (19K) [text/csv]\n","Saving to: ‘ISBI2016_ISIC_Part3_Training_GroundTruth.csv’\n","\n","ISBI2016_ISIC_Part3 100%[===================>]  18.96K  --.-KB/s    in 0.001s  \n","\n","2023-05-12 12:49:18 (25.8 MB/s) - ‘ISBI2016_ISIC_Part3_Training_GroundTruth.csv’ saved [19419/19419]\n","\n","--2023-05-12 12:49:18--  https://isic-challenge-data.s3.amazonaws.com/2016/ISBI2016_ISIC_Part3_Test_GroundTruth.csv\n","Resolving isic-challenge-data.s3.amazonaws.com (isic-challenge-data.s3.amazonaws.com)... 52.217.124.81, 52.217.161.33, 52.216.43.17, ...\n","Connecting to isic-challenge-data.s3.amazonaws.com (isic-challenge-data.s3.amazonaws.com)|52.217.124.81|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 6822 (6.7K) [text/csv]\n","Saving to: ‘ISBI2016_ISIC_Part3_Test_GroundTruth.csv’\n","\n","ISBI2016_ISIC_Part3 100%[===================>]   6.66K  --.-KB/s    in 0s      \n","\n","2023-05-12 12:49:18 (173 MB/s) - ‘ISBI2016_ISIC_Part3_Test_GroundTruth.csv’ saved [6822/6822]\n","\n","Archive:  ./ISBI2016_ISIC_Part3_Test_Data.zip\n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000003.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000012.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000013.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000014.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000015.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000020.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000022.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000023.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000027.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000036.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000037.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000040.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000043.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000052.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000053.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000056.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000057.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000064.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000066.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000069.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000071.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000072.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000088.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000092.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000098.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000099.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000101.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000107.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000111.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000113.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000115.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000117.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000125.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000126.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000129.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000132.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000136.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000138.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000141.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000149.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000160.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000161.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000164.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000165.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000169.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000172.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000174.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000177.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000188.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000195.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000196.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000197.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000198.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000200.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000201.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000202.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000212.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000213.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000222.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000226.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000227.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000228.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000230.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000231.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000233.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000234.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000246.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000253.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000254.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000257.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000258.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000271.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000279.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000287.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000289.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000298.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000299.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000302.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000306.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000310.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000311.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000319.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000320.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000325.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000327.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000328.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000340.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000343.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000354.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000357.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000368.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000371.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000377.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000378.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000380.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000388.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000392.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000393.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000407.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000418.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000420.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000433.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000448.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000449.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000456.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000466.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000470.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000476.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000479.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000482.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000484.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000487.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000490.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000494.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000499.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000501.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000508.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000509.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000510.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000515.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000518.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000525.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000527.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000533.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000534.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000537.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000539.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000540.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000547.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000549.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0000550.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001100.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001103.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001128.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001131.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001142.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001181.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001185.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001186.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001190.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001204.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001242.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001299.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001427.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001484.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001685.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0001960.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0002107.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0002246.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0002673.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0002829.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0002871.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0003056.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0003559.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0003728.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0004115.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0004346.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0005000.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0006193.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0006711.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0007322.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0007693.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0008116.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0008207.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0008406.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0008507.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0008600.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0008626.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0008659.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0008992.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0008998.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009035.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009078.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009083.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009201.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009298.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009564.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009869.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009872.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009874.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009879.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009880.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009881.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009882.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009885.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009889.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009891.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009898.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009901.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009902.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009906.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009918.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009920.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009923.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009926.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009927.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009928.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009930.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009931.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009943.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009945.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009946.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009948.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009954.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009955.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009956.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009958.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009959.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009965.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009970.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009977.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009980.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009982.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009988.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009990.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009992.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009993.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009994.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0009998.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010004.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010009.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010011.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010013.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010016.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010018.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010020.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010023.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010028.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010033.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010034.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010037.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010038.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010041.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010047.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010055.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010058.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010059.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010061.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010062.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010073.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010077.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010088.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010089.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010092.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010100.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010103.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010171.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010173.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010175.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010180.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010183.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010187.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010190.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010192.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010193.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010201.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010202.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010206.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010207.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010215.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010216.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010229.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010231.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010234.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010238.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010254.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010255.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010257.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010261.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010326.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010331.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010336.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010340.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010346.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010347.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010348.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010360.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010368.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010369.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010373.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010374.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010377.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010378.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010379.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010437.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010444.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010448.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010449.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010451.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010452.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010454.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010456.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010460.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010463.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010474.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010477.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010483.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010494.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010498.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010552.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010553.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010556.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010565.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010574.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010582.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010584.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010587.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010588.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010591.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010592.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010596.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010597.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010598.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010599.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010604.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010606.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010607.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010846.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010847.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010854.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010856.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0010863.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011080.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011081.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011083.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011089.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011090.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011092.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011098.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011101.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011104.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011107.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011110.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011112.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011122.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011129.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011132.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011143.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011148.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011149.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011150.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011151.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011152.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011155.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011162.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011167.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011168.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011171.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011172.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011175.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011176.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011177.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011204.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011205.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011213.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011219.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011224.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011227.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011292.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011294.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011298.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011300.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011305.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011310.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011319.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011321.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011325.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011333.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011336.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011338.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011344.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011349.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011359.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011363.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011367.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011374.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011384.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011386.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Test_Data/ISIC_0011392.jpg  \n","Archive:  ./ISBI2016_ISIC_Part3_Training_Data.zip\n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000000.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000001.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000002.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000004.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000006.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000007.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000008.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000009.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000010.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000011.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000016.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000017.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000018.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000019.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000021.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000024.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000025.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000026.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000028.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000029.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000030.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000031.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000032.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000034.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000035.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000038.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000039.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000041.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000042.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000044.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000045.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000046.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000047.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000048.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000049.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000050.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000051.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000054.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000055.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000058.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000059.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000060.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000061.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000062.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000063.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000065.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000067.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000068.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000073.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000074.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000075.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000077.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000078.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000079.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000080.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000081.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000082.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000085.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000086.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000087.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000089.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000091.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000093.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000094.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000095.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000096.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000097.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000100.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000102.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000103.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000104.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000105.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000108.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000109.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000110.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000112.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000114.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000116.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000118.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000119.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000120.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000121.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000122.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000123.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000124.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000127.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000128.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000130.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000131.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000133.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000134.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000135.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000137.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000139.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000140.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000142.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000143.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000145.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000146.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000147.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000148.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000150.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000151.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000152.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000153.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000154.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000155.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000156.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000157.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000159.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000162.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000163.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000166.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000167.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000170.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000171.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000173.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000175.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000176.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000179.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000181.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000182.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000183.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000184.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000185.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000186.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000187.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000189.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000190.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000191.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000192.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000193.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000199.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000203.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000204.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000205.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000206.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000207.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000208.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000209.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000210.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000211.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000214.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000215.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000216.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000217.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000218.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000219.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000220.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000221.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000223.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000224.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000225.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000229.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000232.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000235.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000236.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000237.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000239.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000240.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000242.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000243.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000244.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000245.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000247.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000249.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000250.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000251.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000252.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000255.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000256.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000259.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000260.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000261.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000262.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000263.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000264.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000265.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000268.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000269.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000274.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000275.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000276.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000277.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000278.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000280.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000281.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000282.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000283.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000285.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000288.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000290.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000292.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000293.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000294.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000295.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000297.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000300.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000301.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000303.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000307.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000313.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000314.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000315.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000316.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000317.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000321.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000322.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000323.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000324.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000326.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000329.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000330.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000331.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000332.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000333.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000336.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000337.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000338.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000339.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000341.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000342.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000344.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000345.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000346.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000347.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000348.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000349.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000350.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000351.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000352.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000353.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000355.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000358.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000359.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000360.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000361.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000363.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000364.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000365.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000366.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000367.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000369.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000370.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000372.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000374.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000376.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000379.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000381.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000382.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000383.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000384.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000385.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000386.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000387.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000390.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000391.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000395.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000396.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000397.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000403.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000408.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000409.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000410.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000412.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000413.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000415.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000416.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000419.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000421.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000423.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000425.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000426.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000427.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000431.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000434.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000436.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000439.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000442.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000443.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000444.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000445.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000447.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000451.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000452.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000453.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000454.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000455.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000457.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000458.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000460.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000461.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000463.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000465.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000467.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000468.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000469.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000471.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000473.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000474.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000475.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000477.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000478.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000480.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000481.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000483.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000485.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000486.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000488.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000489.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000491.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000492.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000493.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000495.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000496.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000498.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000500.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000503.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000504.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000505.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000506.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000507.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000511.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000513.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000514.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000516.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000517.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000519.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000520.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000521.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000522.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000523.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000524.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000528.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000529.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000530.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000531.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000532.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000535.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000536.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000538.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000541.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000542.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000543.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000544.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000545.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000546.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000548.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000551.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000552.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000554.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000555.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000556.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000882.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000900.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0000999.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001102.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001105.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001106.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001118.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001119.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001126.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001133.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001134.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001140.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001148.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001152.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001163.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001184.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001187.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001188.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001191.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001212.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001213.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001216.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001247.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001254.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001262.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001267.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001275.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001286.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001292.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001296.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001306.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001367.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001372.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001374.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001385.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001423.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001442.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001449.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0001742.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002093.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002206.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002251.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002287.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002353.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002374.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002438.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002439.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002453.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002459.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002469.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002476.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002488.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002489.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002616.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002647.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002780.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002806.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002836.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002879.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002885.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002948.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002975.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0002976.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0003005.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0003051.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0003174.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0003308.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0003346.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0004110.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0004166.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0004168.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0004309.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0004715.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0004985.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0005187.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0005247.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0005548.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0005555.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0005564.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0005620.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0005639.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0005666.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0005787.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0006021.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0006114.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0006326.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0006350.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0006612.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0006776.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0006795.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0006800.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0006940.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0006982.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0007038.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0007087.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0007475.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0007557.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0007760.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0007788.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008029.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008145.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008236.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008256.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008280.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008294.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008347.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008396.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008403.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008524.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008528.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008541.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008552.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008785.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008807.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008879.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008913.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0008993.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009160.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009165.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009188.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009252.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009297.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009344.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009430.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009504.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009505.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009533.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009583.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009599.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009758.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009800.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009860.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009868.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009870.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009871.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009873.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009875.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009877.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009883.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009884.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009888.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009893.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009895.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009896.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009897.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009899.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009900.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009904.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009905.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009909.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009910.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009911.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009912.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009914.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009915.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009917.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009919.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009921.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009925.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009929.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009932.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009933.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009934.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009935.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009936.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009937.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009938.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009939.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009940.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009941.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009942.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009944.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009947.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009949.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009950.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009951.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009953.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009960.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009961.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009962.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009963.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009964.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009966.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009967.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009968.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009969.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009971.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009972.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009973.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009974.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009975.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009976.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009978.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009979.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009981.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009983.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009986.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009987.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009991.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0009995.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010000.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010001.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010002.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010003.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010005.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010006.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010010.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010014.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010015.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010017.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010019.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010021.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010022.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010024.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010025.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010029.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010032.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010035.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010036.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010040.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010042.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010043.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010044.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010046.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010051.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010052.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010053.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010054.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010056.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010057.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010060.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010063.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010064.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010065.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010066.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010067.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010068.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010069.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010070.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010071.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010074.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010075.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010078.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010079.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010080.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010081.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010083.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010086.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010087.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010090.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010091.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010093.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010094.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010101.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010102.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010104.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010105.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010168.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010169.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010170.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010174.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010176.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010177.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010178.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010182.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010184.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010185.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010186.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010189.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010191.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010194.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010203.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010204.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010205.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010212.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010213.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010218.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010219.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010220.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010222.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010223.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010225.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010226.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010227.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010228.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010230.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010232.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010233.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010235.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010236.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010237.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010239.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010240.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010241.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010242.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010244.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010246.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010247.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010248.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010249.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010251.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010252.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010256.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010262.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010263.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010264.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010265.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010266.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010267.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010317.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010318.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010319.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010320.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010321.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010322.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010323.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010324.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010325.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010327.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010329.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010330.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010332.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010333.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010334.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010335.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010337.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010339.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010341.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010342.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010344.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010349.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010350.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010351.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010352.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010356.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010357.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010358.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010361.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010362.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010364.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010365.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010367.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010370.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010371.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010372.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010380.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010382.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010435.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010436.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010438.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010439.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010440.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010441.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010442.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010443.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010445.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010447.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010450.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010455.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010457.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010458.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010459.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010461.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010462.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010464.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010465.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010466.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010467.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010468.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010471.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010472.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010473.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010475.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010476.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010479.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010480.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010481.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010487.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010488.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010490.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010491.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010492.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010493.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010495.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010496.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010497.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010554.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010557.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010558.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010562.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010566.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010567.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010568.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010569.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010570.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010571.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010572.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010573.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010575.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010576.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010577.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010581.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010585.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010586.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010589.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010590.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010593.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010594.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010595.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010602.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010603.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010605.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010844.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010848.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010849.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010850.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010851.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010852.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010853.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010857.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010858.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010860.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010861.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010862.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0010864.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011079.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011082.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011084.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011085.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011088.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011095.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011097.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011099.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011100.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011102.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011105.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011109.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011114.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011115.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011116.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011117.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011118.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011119.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011120.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011121.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011123.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011124.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011125.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011126.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011127.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011128.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011130.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011131.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011135.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011136.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011137.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011139.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011140.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011141.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011144.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011145.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011146.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011156.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011157.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011158.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011159.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011161.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011163.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011164.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011165.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011166.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011169.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011170.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011173.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011199.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011200.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011202.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011203.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011207.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011208.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011210.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011211.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011212.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011214.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011215.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011217.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011218.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011220.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011223.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011225.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011226.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011228.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011229.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011230.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011295.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011296.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011297.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011299.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011301.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011303.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011304.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011306.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011315.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011317.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011322.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011323.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011324.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011326.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011327.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011328.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011329.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011330.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011331.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011332.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011334.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011339.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011341.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011343.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011345.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011346.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011347.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011348.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011350.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011352.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011353.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011354.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011356.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011357.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011358.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011360.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011361.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011362.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011366.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011372.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011373.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011378.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011380.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011382.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011383.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011385.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011387.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011390.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011393.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011397.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011398.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011400.jpg  \n"," extracting: ISBI2016_ISIC_Part3_Training_Data/ISIC_0011402.jpg  \n"]}],"source":["!wget https://isic-challenge-data.s3.amazonaws.com/2016/ISBI2016_ISIC_Part3_Training_Data.zip\n","!wget https://isic-challenge-data.s3.amazonaws.com/2016/ISBI2016_ISIC_Part3_Test_Data.zip\n","!wget https://isic-challenge-data.s3.amazonaws.com/2016/ISBI2016_ISIC_Part3_Training_GroundTruth.csv\n","!wget https://isic-challenge-data.s3.amazonaws.com/2016/ISBI2016_ISIC_Part3_Test_GroundTruth.csv\n","!unzip \"./ISBI2016_ISIC_Part3_Test_Data.zip\"\n","!unzip \"./ISBI2016_ISIC_Part3_Training_Data.zip\""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"o9aCJwQKOAmg"},"outputs":[],"source":["# !pip install pytorch-lightning==1.8.1\n","# !pip install lightning-bolts\n","# !pip install --upgrade torch torchvision"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9KKGmk3SN3Ql"},"outputs":[],"source":["# import pytorch_lightning as pl\n","# from pl_bolts.models.self_supervised import FixMatch"]},{"cell_type":"markdown","metadata":{"id":"RovDpxZFi-KA"},"source":["### 2, Make training and test image folders by traning and test csv files"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2WLrB9eWG3Nn","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1683895768199,"user_tz":-480,"elapsed":2639,"user":{"displayName":"BonKong Lai","userId":"14934257860777894140"}},"outputId":"5d7e7328-68cb-42ea-c99f-8bae7a0976f7"},"outputs":[{"output_type":"stream","name":"stdout","text":["Number of images: 900\n","Number of training images: 270\n","Number of unlabeled images: 540\n","Number of validation images: 90\n","Number of test images: 379\n"]}],"source":["########## ONLY RUN THIS CELL CAN ONCE ##########\n","# Remove if exists, and create train, unlabeled val, test folders\n","train_path = \"./train\"\n","unlabeled_path = \"./unlabeled\"\n","val_path = \"./val\"\n","test_path = \"./test\"\n","\n","for path in [train_path, unlabeled_path, val_path, test_path]:\n","    if os.path.exists(path):\n","        shutil.rmtree(path)\n","    os.makedirs(path)\n","\n","for path in [train_path, unlabeled_path, val_path, test_path]:\n","    os.makedirs(os.path.join(path, \"benign\"))\n","    os.makedirs(os.path.join(path, \"malignant\"))\n","\n","os.makedirs(os.path.join(unlabeled_path, \"data\"))\n","\n","# Copy images to train, unlabeled, val folders\n","df = pd.read_csv(\"./ISBI2016_ISIC_Part3_Training_GroundTruth.csv\")\n","img_lis = []\n","lbl_lis = []\n","img_lis.append(\"ISIC_0000000\")\n","lbl_lis.append(\"benign\")\n","for i in range(len(df)):\n","    name, label = df[\"ISIC_0000000\"][i], df[\"benign\"][i]\n","    img_lis.append(name)\n","    lbl_lis.append(label)\n","\n","# Define the number of images in each category\n","N_total = len(img_lis)\n","N_train = 270\n","N_unlabeled = 540\n","\n","# Shuffle the data and split into train, unlabeled, val\n","shuffle_ix = np.random.permutation(np.arange(N_total))\n","ix_train = shuffle_ix[:N_train]\n","ix_unlabeled = shuffle_ix[N_train : N_train + N_unlabeled]\n","ix_val = shuffle_ix[N_train + N_unlabeled:]\n","\n","for i in ix_train:\n","    name, label = img_lis[i], lbl_lis[i]\n","    shutil.copy(\"./ISBI2016_ISIC_Part3_Training_Data/\"+name+\".jpg\", \"./train/\"+label+\"/\"+name+\".jpg\")\n","for i in ix_unlabeled:\n","    name = img_lis[i]\n","    shutil.copy(\"./ISBI2016_ISIC_Part3_Training_Data/\"+name+\".jpg\", \"./unlabeled/data/\"+name+\".jpg\")\n","for i in ix_val:\n","    name, label = img_lis[i], lbl_lis[i]\n","    shutil.copy(\"./ISBI2016_ISIC_Part3_Training_Data/\"+name+\".jpg\", \"./val/\"+label+\"/\"+name+\".jpg\")  \n","\n","# Copy images to test folder\n","df = pd.read_csv(\"./ISBI2016_ISIC_Part3_Test_GroundTruth.csv\")\n","shutil.copy(\"./ISBI2016_ISIC_Part3_Test_Data/ISIC_0000003.jpg\", \"./test/benign/ISIC_0000003.jpg\")\n","for i in range(len(df)):\n","    name, label = df[\"ISIC_0000003\"][i], df[\"0.0\"][i]\n","    label = \"benign\" if label == 0 else \"malignant\"\n","    shutil.copy(\"./ISBI2016_ISIC_Part3_Test_Data/\"+name+\".jpg\", \"./test/\"+label+\"/\"+name+\".jpg\")\n","\n","# Print out the number of images in each folder\n","print(f'Number of images: {len(img_lis)}')\n","print(f'Number of training images: {len(ix_train)}')\n","print(f'Number of unlabeled images: {len(ix_unlabeled)}')\n","print(f'Number of validation images: {len(ix_val)}')\n","print(f'Number of test images: {len(df)+1}')"]},{"cell_type":"markdown","metadata":{"id":"xqFLN7Lf79zv"},"source":["### 3.1, Build train, unlabeled, val loaders"]},{"cell_type":"code","execution_count":115,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":334,"status":"ok","timestamp":1683908638349,"user":{"displayName":"BonKong Lai","userId":"14934257860777894140"},"user_tz":-480},"id":"f-ChMb6Y8LEJ","outputId":"dd4b950e-0606-48c0-8742-e525f55d2102"},"outputs":[{"output_type":"stream","name":"stdout","text":["Shape of image: torch.Size([3, 224, 224])\n","Number of training batches: 23\n","Number of unlabeled batches: 45\n","Number of validation batches: 8\n","Number of test batches: 32\n"]}],"source":["# Data augmentation for weak and strong versions\n","normalization = transforms.Compose([\n","    transforms.Resize(244),\n","    transforms.CenterCrop(224),\n","    transforms.ToTensor(),\n","    transforms.Normalize(mean=0.5, std=0.5)\n","])\n","\n","aug_normalization = transforms.Compose([\n","    transforms.Resize(244),\n","    transforms.RandomVerticalFlip(),\n","    transforms.RandomHorizontalFlip(),\n","    # transforms.ColorJitter(brightness=0.5, contrast=1, saturation=0.1, hue=0.5),\n","    transforms.RandomCrop(224),\n","    transforms.ToTensor(),\n","    transforms.Normalize(mean=0.65, std=0.5)\n","])\n","\n","# Create unlabeled dataset for ImageFolder problem\n","class unlabeledDataset(Dataset):\n","    def __init__(self, root, transform=None):\n","        self.root = root\n","        self.transform = transform\n","        self.samples = self._gather_unlabeled_samples(root)\n","\n","    def _gather_unlabeled_samples(self, root):\n","        samples = []\n","        for filename in os.listdir(root):\n","            if filename.endswith(\".jpg\"):\n","                path = os.path.join(root, filename)\n","                samples.append((path, -1))  # -1 indicates no label is provided\n","        return samples\n","\n","    def __getitem__(self, index):\n","        path, target = self.samples[index]\n","        img = Image.open(path).convert('RGB')\n","        img = self.transform(img) if self.transform is not None else img\n","        return img, target\n","\n","    def __len__(self):\n","        return len(self.samples)\n","\n","# Load data in batches\n","def dataloader(batch_size=12):\n","    train_dataset = ImageFolder('./train', transform=aug_normalization)\n","    loader_train = torch.utils.data.DataLoader(\n","        dataset=train_dataset,\n","        batch_size=batch_size,\n","        shuffle=True\n","    )\n","\n","    unlabeled_dataset = unlabeledDataset('./unlabeled/data', transform=normalization)\n","    loader_unlabeled = torch.utils.data.DataLoader(\n","        dataset=unlabeled_dataset,\n","        batch_size=batch_size,\n","        shuffle=True\n","    )\n","\n","    val_dataset = ImageFolder('./val', transform=normalization)\n","    loader_val = torch.utils.data.DataLoader(\n","        dataset=val_dataset,\n","        batch_size=batch_size,\n","        shuffle=False\n","    )\n","    \n","    test_dataset = ImageFolder('./test', transform=normalization)\n","    loader_test = torch.utils.data.DataLoader(\n","        dataset=test_dataset,\n","        batch_size=batch_size,\n","        shuffle=False\n","    )\n","\n","    return loader_train, loader_unlabeled, loader_val, loader_test\n","\n","batch_size = 12\n","loader_train, loader_unlabeled, loader_val, loader_test = dataloader(batch_size)\n","\n","# Checkpoint\n","print(f'Shape of image: {loader_train.dataset[0][0].shape}')        #[3, 224, 224]\n","print(f'Number of training batches: {len(loader_train)}')           #23\n","print(f'Number of unlabeled batches: {len(loader_unlabeled)}')    #45\n","print(f'Number of validation batches: {len(loader_val)}')           #8\n","print(f'Number of test batches: {len(loader_test)}')                #32"]},{"cell_type":"markdown","metadata":{"id":"zrEdDAUPmJtt"},"source":["### 4, Build the network"]},{"cell_type":"code","execution_count":116,"metadata":{"executionInfo":{"elapsed":1256,"status":"ok","timestamp":1683908644805,"user":{"displayName":"BonKong Lai","userId":"14934257860777894140"},"user_tz":-480},"id":"ggxJrmzPmP8L"},"outputs":[],"source":["# 3x3 Convolutional Layer\n","def conv3x3(in_planes, out_planes, stride=1):\n","    return nn.Conv2d(in_planes, out_planes, kernel_size=3, stride=stride,\n","                     padding=1, bias=False)\n","\n","# Basic Block with 2 Convolutional Layers\n","class BasicBlock(nn.Module):\n","    expansion = 1\n","    def __init__(self, inplanes, planes, stride=1, downsample=None):\n","        super(BasicBlock, self).__init__()\n","        self.conv1 = conv3x3(inplanes, planes, stride)\n","        self.bn1 = nn.BatchNorm2d(planes)\n","        self.relu = nn.ReLU(inplace=True)\n","        self.conv2 = conv3x3(planes, planes)\n","        self.bn2 = nn.BatchNorm2d(planes)\n","        self.downsample = downsample\n","        self.stride = stride\n","\n","    def forward(self, x):\n","        residual = x\n","        out = self.conv1(x)\n","        out = self.bn1(out)\n","        out = self.relu(out)\n","        out = self.conv2(out)\n","        out = self.bn2(out)\n","        if self.downsample is not None:\n","            residual = self.downsample(x)\n","        out += residual\n","        out = self.relu(out)\n","        return out\n","\n","# Bottleneck Block with 3 Convolutional Layers\n","class Bottleneck(nn.Module):\n","    expansion = 4\n","    def __init__(self, inplanes, planes, stride=1, downsample=None):\n","        super(Bottleneck, self).__init__()\n","        self.conv1 = nn.Conv2d(inplanes, planes, kernel_size=1, bias=False)\n","        self.bn1 = nn.BatchNorm2d(planes)\n","        self.conv2 = nn.Conv2d(planes, planes, kernel_size=3, stride=stride,\n","                               padding=1, bias=False)\n","        self.bn2 = nn.BatchNorm2d(planes)\n","        self.conv3 = nn.Conv2d(planes, planes * 4, kernel_size=1, bias=False)\n","        self.bn3 = nn.BatchNorm2d(planes * 4)\n","        self.relu = nn.ReLU(inplace=True)\n","        self.downsample = downsample\n","        self.stride = stride\n","\n","    def forward(self, x):\n","        residual = x\n","        out = self.conv1(x)\n","        out = self.bn1(out)\n","        out = self.relu(out)\n","        out = self.conv2(out)\n","        out = self.bn2(out)\n","        out = self.relu(out)\n","        out = self.conv3(out)\n","        out = self.bn3(out)\n","        if self.downsample is not None:\n","            residual = self.downsample(x)\n","        out += residual\n","        out = self.relu(out)\n","        return out\n","\n","# Customized ResNet Architecture\n","class ResNet(nn.Module):\n","    def __init__(self, block, layers, use_fc=False, dropout=None):\n","        self.inplanes = 64\n","        super(ResNet, self).__init__()\n","        self.conv1 = nn.Conv2d(3, 64, kernel_size=7, stride=2, padding=3,bias=False)\n","        self.bn1 = nn.BatchNorm2d(64)\n","        self.relu = nn.ReLU(inplace=True)\n","        self.maxpool = nn.MaxPool2d(kernel_size=3, stride=2, padding=1)\n","        self.layer1 = self._make_layer(block, 64, layers[0])\n","        self.layer2 = self._make_layer(block, 128, layers[1], stride=2)\n","        self.layer3 = self._make_layer(block, 256, layers[2], stride=2)\n","        self.layer4 = self._make_layer(block, 512, layers[3], stride=2)\n","        self.avgpool = nn.AvgPool2d(7, stride=1)\n","        self.use_fc = use_fc\n","        self.use_dropout = True if dropout else False\n","        if self.use_fc:\n","            print('Using fc.')\n","            self.fc_add = nn.Linear(512*block.expansion, 512)\n","        if self.use_dropout:\n","            print('Using dropout.')\n","            self.dropout = nn.Dropout(p=dropout)\n","        for m in self.modules():\n","            if isinstance(m, nn.Conv2d):\n","                n = m.kernel_size[0] * m.kernel_size[1] * m.out_channels\n","                m.weight.data.normal_(0, math.sqrt(2. / n))\n","            elif isinstance(m, nn.BatchNorm2d):\n","                m.weight.data.fill_(1)\n","                m.bias.data.zero_()\n","\n","    def _make_layer(self, block, planes, blocks, stride=1):\n","        downsample = None\n","        if stride != 1 or self.inplanes != planes * block.expansion:\n","            downsample = nn.Sequential(\n","                nn.Conv2d(self.inplanes, planes * block.expansion,\n","                          kernel_size=1, stride=stride, bias=False),\n","                nn.BatchNorm2d(planes * block.expansion),\n","            )\n","        layers = []\n","        layers.append(block(self.inplanes, planes, stride, downsample))\n","        self.inplanes = planes * block.expansion\n","        for i in range(1, blocks):\n","            layers.append(block(self.inplanes, planes))\n","        return nn.Sequential(*layers)\n","\n","    def forward(self, x, *args):\n","        x = self.conv1(x)\n","        x = self.bn1(x)\n","        x = self.relu(x)\n","        x = self.maxpool(x)\n","        x = self.layer1(x)\n","        x = self.layer2(x)\n","        x = self.layer3(x)\n","        x = self.layer4(x)\n","        x = self.avgpool(x)\n","        x = x.mean(dim=(-2, -1))\n","        x = x.view(x.size(0), -1)\n","        if self.use_fc:\n","            x = F.relu(self.fc_add(x))\n","        if self.use_dropout:\n","            x = self.dropout(x)\n","        return x\n","\n","# Create ResNet50 Model with / without Pre-trained Weights and dropout\n","def get_resnet50(pre_trained=True):\n","    Resnet50 = ResNet(Bottleneck, [3, 4, 6, 3], dropout=False)\n","    if pre_trained:\n","        pre_trained_model = _resnet50(weights = \"IMAGENET1K_V2\")\n","        pre_trained = pre_trained_model.state_dict()\n","        new_weights = {k: pre_trained[k] for k in Resnet50.state_dict()}\n","        Resnet50.load_state_dict(new_weights)\n","    return Resnet50\n","\n","# Define the high-level model\n","class Model(nn.Module):\n","    def __init__(self, encoder, num_classes=1):\n","        super(Model, self).__init__()\n","        self.encoder = encoder\n","        self.classifier = nn.Linear(2048, num_classes)\n","        self.final_actv = nn.Sigmoid()\n","    def forward(self, x):\n","        x = self.encoder(x)\n","        x = self.classifier(x)\n","        x = self.final_actv(x)\n","        return x\n","    \n","resnet50 = get_resnet50(pre_trained=True)\n","model = Model(resnet50, 1)\n","\n","# Move the model to the GPU\n","device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","model = model.to(device)\n","\n","# Print the summary\n","input_size = (3, 224, 224)  # Input size for ResNet-50 model (channels, height, width)\n","#summary(model, input_size)"]},{"cell_type":"code","source":["def gpu_clean():\n","    gc.collect()\n","    torch.cuda.empty_cache()"],"metadata":{"id":"IcZzpeBpUOFi","executionInfo":{"status":"ok","timestamp":1683901008932,"user_tz":-480,"elapsed":4,"user":{"displayName":"BonKong Lai","userId":"14934257860777894140"}}},"execution_count":74,"outputs":[]},{"cell_type":"code","execution_count":117,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":437},"id":"fEkmU_zQ76oy","executionInfo":{"status":"error","timestamp":1683908867594,"user_tz":-480,"elapsed":218532,"user":{"displayName":"BonKong Lai","userId":"14934257860777894140"}},"outputId":"54ea8719-b0f0-4e90-8b60-24bf9486824b"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch [1/5], Loss: 0.5845730926679529, Unlabeled Train Acc: 77.17391304347827%, Unlabeled Train AUC: 0.589301967373801, Val Acc: 81.11111111111111%, Val AUC: 0.508460918614021\n","Epoch [2/5], Loss: 0.6291957795619965, Unlabeled Train Acc: 92.02898550724638%, Unlabeled Train AUC: 0.6296992481203008, Val Acc: 67.77777777777779%, Val AUC: 0.5124899274778405\n","Epoch [3/5], Loss: 0.6704995366542236, Unlabeled Train Acc: 95.65217391304348%, Unlabeled Train AUC: 0.6571691176470589, Val Acc: 80.0%, Val AUC: 0.49637389202256244\n","Epoch [4/5], Loss: 0.6283794887687849, Unlabeled Train Acc: 97.46376811594203%, Unlabeled Train AUC: 0.6678832116788321, Val Acc: 81.11111111111111%, Val AUC: 0.49717969379532634\n"]},{"output_type":"error","ename":"ValueError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)","\u001b[0;32m<ipython-input-117-6c0aa903005b>\u001b[0m in \u001b[0;36m<cell line: 115>\u001b[0;34m()\u001b[0m\n\u001b[1;32m    113\u001b[0m \u001b[0mmy_lr_scheduler\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0moptim\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlr_scheduler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mExponentialLR\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moptimizer\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0moptimizer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgamma\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m0.96\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    114\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 115\u001b[0;31m \u001b[0mmean_teacher_model\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mUNLAB_ACC_TRAIN\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mUNLAB_AUC_TRAIN\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mACC_VAL\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mAUC_VAL\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtrain_mean_teacher\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmean_teacher_model\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mloader_train\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mloader_unlabeled\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mloader_val\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moptimizer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mconsistency_criterion\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msupervised_criterion\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdevice\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mepochs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m5\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m<ipython-input-117-6c0aa903005b>\u001b[0m in \u001b[0;36mtrain_mean_teacher\u001b[0;34m(model, labeled_loader, unlabeled_loader, loader_val, optimizer, consistency_criterion, supervised_criterion, device, epochs)\u001b[0m\n\u001b[1;32m     64\u001b[0m         \u001b[0munlabeled_lbl\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0munlabeled_pred\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marray\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0munlabeled_lbl\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marray\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0munlabeled_pred\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     65\u001b[0m         \u001b[0munlabeled_pred_lbl\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0maround\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0munlabeled_pred\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 66\u001b[0;31m         \u001b[0munlabeled_train_auc\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mroc_auc_score\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0munlabeled_lbl\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0munlabeled_pred\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     67\u001b[0m         \u001b[0munlabeled_train_acc\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0maccuracy_score\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0munlabeled_lbl\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0munlabeled_pred_lbl\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     68\u001b[0m         \u001b[0munlabeled_acc_train_list\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0munlabeled_train_acc\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_ranking.py\u001b[0m in \u001b[0;36mroc_auc_score\u001b[0;34m(y_true, y_score, average, sample_weight, max_fpr, multi_class, labels)\u001b[0m\n\u001b[1;32m    570\u001b[0m         \u001b[0mlabels\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0munique\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_true\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    571\u001b[0m         \u001b[0my_true\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlabel_binarize\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_true\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mclasses\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mlabels\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 572\u001b[0;31m         return _average_binary_score(\n\u001b[0m\u001b[1;32m    573\u001b[0m             \u001b[0mpartial\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0m_binary_roc_auc_score\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmax_fpr\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmax_fpr\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    574\u001b[0m             \u001b[0my_true\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_base.py\u001b[0m in \u001b[0;36m_average_binary_score\u001b[0;34m(binary_metric, y_true, y_score, average, sample_weight)\u001b[0m\n\u001b[1;32m     73\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     74\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0my_type\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m\"binary\"\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 75\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mbinary_metric\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_true\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_score\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msample_weight\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0msample_weight\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     76\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     77\u001b[0m     \u001b[0mcheck_consistent_length\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_true\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_score\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msample_weight\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_ranking.py\u001b[0m in \u001b[0;36m_binary_roc_auc_score\u001b[0;34m(y_true, y_score, sample_weight, max_fpr)\u001b[0m\n\u001b[1;32m    337\u001b[0m     \u001b[0;34m\"\"\"Binary roc auc score.\"\"\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    338\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0munique\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_true\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m!=\u001b[0m \u001b[0;36m2\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 339\u001b[0;31m         raise ValueError(\n\u001b[0m\u001b[1;32m    340\u001b[0m             \u001b[0;34m\"Only one class present in y_true. ROC AUC score \"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    341\u001b[0m             \u001b[0;34m\"is not defined in that case.\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mValueError\u001b[0m: Only one class present in y_true. ROC AUC score is not defined in that case."]}],"source":["class MeanTeacherModel(nn.Module):\n","    def __init__(self, student_model, ema_decay):\n","        super().__init__()\n","        self.student_model = student_model\n","        self.teacher_model = copy.deepcopy(student_model)\n","        self.ema_decay = ema_decay\n","\n","    def forward(self, x):\n","        return self.student_model(x)\n","\n","    def update_teacher_model(self):\n","        with torch.no_grad():\n","            for student_params, teacher_params in zip(self.student_model.parameters(), self.teacher_model.parameters()):\n","                teacher_params.data.mul_(self.ema_decay).add_((1 - self.ema_decay) * student_params.data)\n","\n","def train_mean_teacher(model, labeled_loader, unlabeled_loader, loader_val, optimizer, consistency_criterion, supervised_criterion, device, epochs):\n","    loss_train_list = []\n","    loss_val_list = []\n","    unlabeled_auc_train_list = []\n","    unlabeled_acc_train_list = []\n","    auc_val_list = []\n","    acc_val_list = []\n","    model.train()\n","    for epoch in range(epochs):\n","        gpu_clean()\n","        unlabeled_lbl, unlabeled_pred = [], [] ## for AUC\n","        total_loss = 0\n","        for (labeled_imgs, labeled_targets), (unlabeled_imgs, _) in zip(labeled_loader, unlabeled_loader):\n","            labeled_imgs = labeled_imgs.to(device)\n","            labeled_targets = labeled_targets.to(device)\n","            unlabeled_imgs = unlabeled_imgs.to(device)\n","            \n","            # Clear gradients\n","            optimizer.zero_grad()\n","\n","            # Labeled data\n","            labeled_preds = model.student_model(labeled_imgs)\n","            labeled_targets = labeled_targets.unsqueeze(1)\n","            labeled_targets = labeled_targets.float()\n","            supervised_loss = supervised_criterion(labeled_preds, labeled_targets)\n","\n","            # Unlabeled data\n","            unlabeled_preds_student = model.student_model(unlabeled_imgs)\n","            with torch.no_grad():\n","                unlabeled_preds_teacher = model.teacher_model(unlabeled_imgs)\n","            unlabeled_scores = list(unlabeled_preds_student.detach().cpu().numpy())\n","            unlabeled_true = list(np.around(unlabeled_preds_teacher.detach().cpu().numpy()))  ## make teacher outputs as binary label\n","            unlabeled_pred += unlabeled_scores\n","            unlabeled_lbl += unlabeled_true\n","\n","            # Consistency loss and total loss\n","            consistency_loss = consistency_criterion(unlabeled_preds_student, unlabeled_preds_teacher)\n","\n","            # Backward pass and optimization\n","            loss = supervised_loss + consistency_loss\n","            loss.backward()\n","            optimizer.step()\n","\n","            # Update teacher model parameters\n","            model.update_teacher_model()\n","            total_loss += loss.item()\n","\n","        # Unlabeled metrics\n","        unlabeled_lbl, unlabeled_pred = np.array(unlabeled_lbl), np.array(unlabeled_pred)\n","        unlabeled_pred_lbl = np.around(unlabeled_pred)\n","        unlabeled_train_auc = roc_auc_score(unlabeled_lbl, unlabeled_pred)  ## sometime \n","        unlabeled_train_acc = accuracy_score(unlabeled_lbl, unlabeled_pred_lbl)\n","        unlabeled_acc_train_list.append(unlabeled_train_acc)\n","        unlabeled_auc_train_list.append(unlabeled_train_auc)\n","\n","        # Validation\n","        gpu_clean()\n","        val_lbl, val_pred = [], [] ## for AUC\n","        for (imgs, targets) in loader_val:\n","            imgs = imgs.to(device)\n","            targets = targets.to(device)\n","\n","            preds = model.student_model(imgs)\n","            targets = targets.unsqueeze(1)\n","            targets = targets.float()\n","\n","            val_scores = list(preds.detach().cpu().numpy())\n","            val_true = list(targets.detach().cpu().numpy())\n","            val_pred += val_scores\n","            val_lbl += val_true\n","        \n","        val_lbl, val_pred = np.array(val_lbl), np.array(val_pred)\n","        val_pred_lbl = np.around(val_pred)\n","        val_auc = roc_auc_score(val_lbl, val_pred)\n","        val_acc = accuracy_score(val_lbl, val_pred_lbl)\n","        acc_val_list.append(val_acc)\n","        auc_val_list.append(val_auc)\n","\n","        loss_train_list.append(total_loss)\n","        my_lr_scheduler.step()\n","        print(f\"Epoch [{epoch+1}/{epochs}], Loss: {total_loss/len(labeled_loader)}, Unlabeled Train Acc: {unlabeled_acc_train_list[-1]*100}%, Unlabeled Train AUC: {unlabeled_auc_train_list[-1]}, Val Acc: {acc_val_list[-1]*100}%, Val AUC: {auc_val_list[-1]}\")\n","\n","\n","    return model, unlabeled_acc_train_list, unlabeled_auc_train_list, acc_val_list, auc_val_list\n","\n","\n","device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","\n","student_model = model\n","student_model.to(device)\n","\n","mean_teacher_model = MeanTeacherModel(student_model, ema_decay=0.99)\n","mean_teacher_model.to(device)\n","\n","optimizer = torch.optim.Adam(model.parameters(), lr=0.001)\n","consistency_criterion = nn.MSELoss()\n","supervised_criterion = nn.BCELoss()\n","my_lr_scheduler = torch.optim.lr_scheduler.ExponentialLR(optimizer=optimizer, gamma=0.96)\n","\n","mean_teacher_model, UNLAB_ACC_TRAIN, UNLAB_AUC_TRAIN, ACC_VAL, AUC_VAL = train_mean_teacher(mean_teacher_model, loader_train, loader_unlabeled, loader_val, optimizer, consistency_criterion, supervised_criterion, device, epochs=5)"]},{"cell_type":"code","source":["b = np.array([0,0.64,0])\n","print(np.around(b))\n","b[b > 0.5] = 1\n","b[b < 0.5] = 0\n","print(\"np b:\", b)\n","b = list(b)\n","print(\"list b:\", b)\n","a = []\n","a += b"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GOJU60mnM4Kg","executionInfo":{"status":"ok","timestamp":1683899800494,"user_tz":-480,"elapsed":3,"user":{"displayName":"BonKong Lai","userId":"14934257860777894140"}},"outputId":"304f72fb-dd38-4b6f-d24a-ebb5ca173e1e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[0. 1. 0.]\n","np b: [0. 1. 0.]\n","list b: [0.0, 1.0, 0.0]\n"]}]},{"cell_type":"markdown","metadata":{"id":"5Q4AZq_enGEI"},"source":["### 5, Train and test your model"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vfSsJ4AbnEID"},"outputs":[],"source":["max_epoch = 10\n","\n","# Loss function\n","class BCEFocalLoss(nn.Module):\n","    def __init__(self, gamma=2.0, alpha=0.6, reduction='mean'):\n","        super(BCEFocalLoss, self).__init__()\n","        self.gamma = gamma\n","        self.alpha = alpha\n","        self.reduction = reduction\n","\n","    def forward(self, logits, target):\n","        alpha = self.alpha\n","        gamma = self.gamma\n","        loss = - alpha * (1 - logits) ** gamma * target * torch.log(logits) - \\\n","               (1 - alpha) * logits ** gamma * (1 - target) * torch.log(1 - logits)\n","        if self.reduction == 'mean':\n","            loss = loss.mean()\n","        elif self.reduction == 'sum':\n","            loss = loss.sum()\n","        return loss\n","\n","criterion = BCEFocalLoss()\n","optimizer = torch.optim.SGD(model.parameters(), lr=0.01, momentum=0.9)\n","\n","# Training\n","loss_train_list = []\n","loss_val_list = []\n","auc_train_list = []\n","auc_val_list = []\n","acc_train_list = []\n","acc_val_list = []\n","\n","for epoch in range(max_epoch):\n","    train_lbl, train_pred = [], []\n","    running_loss_train = 0.0\n","    print(\" -- Epoch {}/{}\".format(epoch + 1, max_epoch))\n","    model.train()\n","\n","    for data in tqdm(loader_train):\n","        optimizer.zero_grad()\n","        images, labels = data\n","        images = images.to(device)\n","        labels = labels.float().to(device)\n","        outputs = model(images)[:,0]\n","        outputs = torch.sigmoid(outputs)\n","        loss = criterion(outputs, labels)\n","        loss.backward()\n","        optimizer.step()\n","        \n","        running_loss_train += loss.item()\n","        y_scores = list(outputs.detach().cpu().numpy())\n","        y_true = list(labels.detach().cpu().numpy())\n","        train_lbl += y_true\n","        train_pred += y_scores\n","\n","    loss_train = running_loss_train / len(loader_train)\n","    loss_train_list.append(loss_train)\n","    train_lbl, train_pred = np.array(train_lbl), np.array(train_pred)\n","    train_pred_lbl = np.around(train_pred) # pred >= 0.5 pred_lbl = 1 else pred_lbl = 0\n","    train_auc = roc_auc_score(train_lbl, train_pred)\n","    train_acc = accuracy_score(train_lbl, train_pred_lbl)\n","    auc_train_list.append(train_auc)\n","    acc_train_list.append(train_acc)\n","    \n","    # Validation\n","    model.eval()\n","    val_lbl, val_pred = [], []\n","    running_loss_val = 0.0\n","\n","    for data in loader_val:\n","        val_images, val_labels = data\n","        val_images = val_images.to(device)\n","        val_labels = val_labels.float().to(device)\n","        val_outputs = model(val_images)[:, 0]\n","        val_outputs = torch.sigmoid(val_outputs)\n","        val_loss = criterion(val_outputs, val_labels)\n","        \n","        running_loss_val += val_loss.item()\n","        y_scores = list(val_outputs.detach().cpu().numpy())\n","        y_true = list(val_labels.detach().cpu().numpy())\n","        val_lbl += y_true\n","        val_pred += y_scores\n","        \n","    loss_val = running_loss_val / len(loader_val)\n","    loss_val_list.append(loss_val)\n","    val_lbl, val_pred = np.array(val_lbl), np.array(val_pred)\n","    val_pred_lbl = np.around(val_pred) # pred >= 0.5 pred_lbl = 1 else pred_lbl = 0\n","    val_auc = roc_auc_score(val_lbl, val_pred)\n","    val_acc = accuracy_score(val_lbl, val_pred_lbl)\n","    auc_val_list.append(val_auc)\n","    acc_val_list.append(val_acc)\n","    print(loss_train, loss_val, train_auc, val_auc)\n","\n","# Evaluation\n","model.eval()\n","test_lbl, test_pred = [], []\n","\n","for data in loader_test:\n","    test_images, test_labels = data\n","    test_images = test_images.to(device)\n","    test_labels = test_labels.float().to(device)\n","    test_outputs = model(test_images)[:, 0]\n","    test_outputs = torch.sigmoid(test_outputs)\n","    y_scores = list(test_outputs.detach().cpu().numpy())\n","    y_true = list(test_labels.detach().cpu().numpy())\n","    test_lbl += y_true\n","    test_pred += y_scores\n","        \n","test_lbl, test_pred = np.array(test_lbl), np.array(test_pred)\n","test_pred_lbl = np.around(test_pred) # pred >= 0.5 pred_lbl = 1 else pred_lbl = 0\n","test_auc = roc_auc_score(test_lbl, test_pred)\n","test_acc = accuracy_score(test_lbl, test_pred_lbl)\n","print(test_auc, test_acc)"]},{"cell_type":"markdown","metadata":{"id":"HlKYDx8JI4_M"},"source":["### 6, plot your training and test curves"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PB3pjrhWneY_"},"outputs":[],"source":["# Plot loss curve\n","fig = plt.figure()\n","plt.plot(loss_train_list, label='Training Loss')\n","plt.plot(loss_val_list, label='Validation Loss')\n","plt.xlabel('Epoch')\n","plt.ylabel('Loss')\n","plt.title('Loss Curve')\n","plt.legend()\n","plt.show()\n","\n","# Plot accuracy curve\n","fig = plt.figure()\n","plt.plot(acc_train_list, label='Training Accuracy')\n","plt.plot(acc_val_list, label='Validation Accuracy')\n","plt.axhline(y=test_acc, color='r', linestyle='--', label='Test Accuracy')\n","plt.xlabel('Epoch')\n","plt.ylabel('Accuracy')\n","plt.title('Accuracy Curve')\n","plt.legend()\n","plt.show()\n","\n","# Plot AUC curve\n","fig = plt.figure()\n","plt.plot(auc_train_list, label='Training AUC')\n","plt.plot(auc_val_list, label='Validation AUC')\n","plt.axhline(y=test_auc, color='r', linestyle='--', label='Test AUC')\n","plt.xlabel('Epoch')\n","plt.ylabel('AUC')\n","plt.title('AUC Curve')\n","plt.legend()\n","plt.show()"]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[{"file_id":"1DLtw9mX04n0VIn7RPIrnJafnEyfX_CoY","timestamp":1683711057979},{"file_id":"https://github.com/full-stack-deep-learning/fsdl-text-recognizer-2022-labs/blob/main/lab02/notebooks/lab02b_cnn.ipynb","timestamp":1676776020914}],"gpuType":"T4"},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.13"},"vscode":{"interpreter":{"hash":"0f056848cf5d2396a4970b625f23716aa539c2ff5334414c1b5d98d7daae66f6"}}},"nbformat":4,"nbformat_minor":0}